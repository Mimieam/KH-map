/*! leaflet-control-geocoder - v2.0.0-dev - 2015-01-30 */

!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self);var c=b;c=c.L||(c.L={}),c=c.Control||(c.Control={}),c.Geocoder=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){function c(a,b,c){function d(a){return a>=200&&300>a||304===a}function e(){void 0===h.status||d(h.status)?b.call(h,null,h):b.call(h,h,null)}var f=!1;if("undefined"==typeof window.XMLHttpRequest)return b(Error("Browser not supported"));if("undefined"==typeof c){var g=a.match(/^\s*https?:\/\/[^\/]*/);c=g&&g[0]!==location.protocol+"//"+location.domain+(location.port?":"+location.port:"")}var h=new window.XMLHttpRequest;if(c&&!("withCredentials"in h)){h=new window.XDomainRequest;var i=b;b=function(){if(f)i.apply(this,arguments);else{var a=this,b=arguments;setTimeout(function(){i.apply(a,b)},0)}}}return"onload"in h?h.onload=e:h.onreadystatechange=function(){4===h.readyState&&e()},h.onerror=function(a){b.call(this,a||!0,null),b=function(){}},h.onprogress=function(){},h.ontimeout=function(a){b.call(this,a,null),b=function(){}},h.onabort=function(a){b.call(this,a,null),b=function(){}},h.open("GET",a,!0),h.send(null),f=!0,h}"undefined"!=typeof b&&(b.exports=c)},{}],2:[function(a,b){(function(a){!function(){"use strict";var c="undefined"!=typeof window?window.L:"undefined"!=typeof a?a.L:null;b.exports=c.Class.extend({options:{timeout:500,noResultsMessage:"No results found."},initialize:function(a,b,d,e){c.setOptions(this,e),this._elem=a,this._resultFn=e.resultFn?c.Util.bind(e.resultFn,e.resultContext):null,this._autocomplete=e.autocompleteFn?c.Util.bind(e.autocompleteFn,e.autocompleteContext):null,this._selectFn=c.Util.bind(b,d),this._container=c.DomUtil.create("div","leaflet-control-geocoder-result leaflet-bar"),this._resultTable=c.DomUtil.create("table","",this._container),c.DomEvent.addListener(this._elem,"input",this._keyPressed,this),c.DomEvent.addListener(this._elem,"keypress",this._keyPressed,this),c.DomEvent.addListener(this._elem,"keydown",this._keyDown,this),c.DomEvent.addListener(this._elem,"blur",function(){},this)},close:function(){c.DomUtil.removeClass(this._container,"leaflet-control-geocoder-result-open"),this._isOpen=!1},_open:function(){var a=this._elem.getBoundingClientRect();this._container.parentElement||(this._container.style.left=a.left+"px",this._container.style.top=a.bottom+"px",this._container.style.width=a.right-a.left+"px",document.body.appendChild(this._container)),c.DomUtil.addClass(this._container,"leaflet-control-geocoder-result-open"),this._isOpen=!0},_setResults:function(a){var b,d,e,f;for(delete this._selection,this._results=a;this._resultTable.firstChild;)this._resultTable.removeChild(this._resultTable.firstChild);for(b=0;b<a.length;b++)d=c.DomUtil.create("tr","",this._resultTable),d.setAttribute("data-result-index",b),e=c.DomUtil.create("td","",d),a[b].html?e.innerHTML=a[b].html:(f=document.createTextNode(a[b].name),e.appendChild(f)),c.DomEvent.addListener(e,"mousedown",c.DomEvent.preventDefault),c.DomEvent.addListener(e,"click",this._createClickListener(a[b]));b||(d=c.DomUtil.create("tr","",this._resultTable),e=c.DomUtil.create("td","leaflet-control-geocoder-no-results",d),e.innerHTML=this.options.noResultsMessage),this._open(),a.length>0&&this._select(1)},_createClickListener:function(a){var b=this._resultSelected(a);return c.bind(function(){this._elem.blur(),b()},this)},_resultSelected:function(a){return c.bind(function(){this.close(),this._elem.value=a.name,this._lastCompletedText=a.name,this._selectFn(a)},this)},_keyPressed:function(a){var b;return this._isOpen&&13===a.keyCode&&this._selection?(b=parseInt(this._selection.getAttribute("data-result-index"),10),this._resultSelected(this._results[b])(),void c.DomEvent.preventDefault(a)):13===a.keyCode?void this._complete(this._resultFn,!0):this._autocomplete&&document.activeElement===this._elem?(this._timer&&clearTimeout(this._timer),void(this._timer=setTimeout(c.Util.bind(function(){this._complete(this._autocomplete)},this),this.options.timeout))):void this._unselect()},_select:function(a){var b=this._selection;b&&(c.DomUtil.removeClass(b.firstChild,"leaflet-control-geocoder-selected"),b=b[a>0?"nextSibling":"previousSibling"]),b||(b=this._resultTable[a>0?"firstChild":"lastChild"]),b&&(c.DomUtil.addClass(b.firstChild,"leaflet-control-geocoder-selected"),this._selection=b)},_unselect:function(){this._selection&&c.DomUtil.removeClass(this._selection.firstChild,"leaflet-control-geocoder-selected"),delete this._selection},_keyDown:function(a){if(this._isOpen)switch(a.keyCode){case 27:return this.close(),void c.DomEvent.preventDefault(a);case 38:return this._select(-1),void c.DomEvent.preventDefault(a);case 40:return this._select(1),void c.DomEvent.preventDefault(a)}},_complete:function(a,b){function c(a){this._lastCompletedText=d,b&&1===a.length?this._resultSelected(a[0])():this._setResults(a)}var d=this._elem.value;d&&(d!==this._lastCompletedText?a(d,c,this):b&&c.call(this,this._results))}})}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(a,b){(function(c){!function(){"use strict";var d="undefined"!=typeof window?window.L:"undefined"!=typeof c?c.L:null,e=a("./autocomplete");d.Control.Geocoder=d.Control.extend({options:{showResultIcons:!1,collapsed:!0,expand:"click",position:"topright",placeholder:"Search...",errorMessage:"Nothing found."},initialize:function(a){d.Util.setOptions(this,a),this.options.geocoder||(this.options.geocoder=new d.Control.Geocoder.Nominatim)},onAdd:function(a){var b,c="leaflet-control-geocoder",f=d.DomUtil.create("div","leaflet-bar leaflet-control "+c),g=d.DomUtil.create("a","leaflet-control-geocoder-icon",f);return this._map=a,this._container=f,g.href="#",b=this._input=d.DomUtil.create("input"),b.type="text",b.placeholder=this.options.placeholder,new e(b,this._geocodeResultSelected,this,{resultFn:this.options.geocoder.geocode,resultContext:this.options.geocoder,autocompleteFn:this.options.geocoder.suggest,autocompleteContext:this.options.geocoder}),f.appendChild(b),this.options.collapsed?"click"===this.options.expand?d.DomEvent.addListener(g,"click",function(a){0===a.button&&2!==a.detail&&this._toggle()},this):(d.DomEvent.addListener(g,"mouseover",this._expand,this),d.DomEvent.addListener(g,"mouseout",this._collapse,this),this._map.on("movestart",this._collapse,this)):this._expand(),d.DomEvent.disableClickPropagation(f),f},markGeocode:function(a){return this._map.fitBounds(a.bbox),this._geocodeMarker&&this._map.removeLayer(this._geocodeMarker),this._geocodeMarker=new d.Marker(a.center).bindPopup(a.html||a.name).addTo(this._map).openPopup(),this},_geocodeResultSelected:function(a){this.options.collapsed?this._collapse():this._clearResults(),this.markGeocode(a)},_toggle:function(){d.DomUtil.hasClass(this._container,"leaflet-control-geocoder-expanded")?this._collapse():this._expand()},_expand:function(){d.DomUtil.addClass(this._container,"leaflet-control-geocoder-expanded"),this._input.select()},_collapse:function(){this._container.className=this._container.className.replace("leaflet-control-geocoder-expanded","")}}),d.control.geocoder=function(a){return new d.Control.Geocoder(a)},a("./providers/nominatim"),a("./providers/google"),a("./providers/bing"),a("./providers/mapquest"),a("./providers/mapbox"),b.exports=d.Control.Geocoder}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./autocomplete":2,"./providers/bing":4,"./providers/google":5,"./providers/mapbox":6,"./providers/mapquest":7,"./providers/nominatim":8}],4:[function(a,b){(function(c){!function(){"use strict";var d="undefined"!=typeof window?window.L:"undefined"!=typeof c?c.L:null,e=a("corslite");d.Control.Geocoder.Bing=d.Class.extend({initialize:function(a){this.key=a},geocode:function(a,b,c){e("//dev.virtualearth.net/REST/v1/Locations"+d.Util.getParamString({query:a,key:this.key}),function(a,e){var f,g=[];if(!a){f=e.responseText;for(var h=f.resourceSets[0].resources.length-1;h>=0;h--){var i=f.resourceSets[0].resources[h],j=i.bbox;g[h]={name:i.name,bbox:d.latLngBounds([j[0],j[1]],[j[2],j[3]]),center:d.latLng(i.point.coordinates)}}}b.call(c,g)},this,"jsonp")},reverse:function(a,b,c,e){d.Control.Geocoder._jsonp("//dev.virtualearth.net/REST/v1/Locations/"+a.lat+","+a.lng,{key:this.key},function(a){for(var b=[],f=a.resourceSets[0].resources.length-1;f>=0;f--){var g=a.resourceSets[0].resources[f],h=g.bbox;b[f]={name:g.name,bbox:d.latLngBounds([h[0],h[1]],[h[2],h[3]]),center:d.latLng(g.point.coordinates)}}c.call(e,b)},this,"jsonp")}}),d.control.geocoder.bing=function(a){return new d.Control.Geocoder.Bing(a)},b.exports=d.Control.Geocoder}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{corslite:1}],5:[function(a,b){(function(c){!function(){"use strict";var d="undefined"!=typeof window?window.L:"undefined"!=typeof c?c.L:null;a("../control"),d.Control.Geocoder.Google=d.Class.extend({options:{serviceUrl:"https://maps.googleapis.com/maps/api/geocode/json"},initialize:function(a){this._key=a},geocode:function(a,b,c){var e={address:a};this._key&&this._key.length&&(e.key=this._key),d.Control.Geocoder.getJSON(this.options.serviceUrl,e,function(a){var e,f,g,h=[];if(a.results&&a.results.length)for(var i=0;i<=a.results.length-1;i++)e=a.results[i],f=d.latLng(e.geometry.location),g=d.latLngBounds(d.latLng(e.geometry.viewport.northeast),d.latLng(e.geometry.viewport.southwest)),h[i]={name:e.formatted_address,bbox:g,center:f};b.call(c,h)})},reverse:function(a,b,c,e){var f={latlng:encodeURIComponent(a.lat)+","+encodeURIComponent(a.lng)};this._key&&this._key.length&&(f.key=this._key),d.Control.Geocoder.getJSON(this.options.serviceUrl,f,function(a){var b,f,g,h=[];if(a.results&&a.results.length)for(var i=0;i<=a.results.length-1;i++)b=a.results[i],f=d.latLng(b.geometry.location),g=d.latLngBounds(d.latLng(b.geometry.viewport.northeast),d.latLng(b.geometry.viewport.southwest)),h[i]={name:b.formatted_address,bbox:g,center:f};c.call(e,h)})}}),d.Control.Geocoder.google=function(a){return new d.Control.Geocoder.Google(a)},b.exports=d.Control.Geocoder}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../control":3}],6:[function(a,b){(function(c){!function(){"use strict";var d="undefined"!=typeof window?window.L:"undefined"!=typeof c?c.L:null;a("../control"),d.Control.Geocoder.Mapbox=d.Class.extend({options:{serviceUrl:"https://api.tiles.mapbox.com/v4/geocode/mapbox.places-v1/"},initialize:function(a){this._accessToken=a},geocode:function(a,b,c){d.Control.Geocoder.getJSON(this.options.serviceUrl+encodeURIComponent(a)+".json",{access_token:this._accessToken},function(a){var e,f,g,h=[];if(a.features&&a.features.length)for(var i=0;i<=a.features.length-1;i++)e=a.features[i],f=d.latLng(e.center.reverse()),g=e.hasOwnProperty("bbox")?d.latLngBounds(d.latLng(e.bbox.slice(0,2).reverse()),d.latLng(e.bbox.slice(2,4).reverse())):d.latLngBounds(f,f),h[i]={name:e.place_name,bbox:g,center:f};b.call(c,h)})},suggest:function(a,b,c){return this.geocode(a,b,c)},reverse:function(a,b,c,e){d.Control.Geocoder.getJSON(this.options.serviceUrl+encodeURIComponent(a.lng)+","+encodeURIComponent(a.lat)+".json",{access_token:this._accessToken},function(a){var b,f,g,h=[];if(a.features&&a.features.length)for(var i=0;i<=a.features.length-1;i++)b=a.features[i],f=d.latLng(b.center.reverse()),g=b.hasOwnProperty("bbox")?d.latLngBounds(d.latLng(b.bbox.slice(0,2).reverse()),d.latLng(b.bbox.slice(2,4).reverse())):d.latLngBounds(f,f),h[i]={name:b.place_name,bbox:g,center:f};c.call(e,h)})}}),d.control.geocoder.mapbox=function(a){return new d.Control.Geocoder.Mapbox(a)},b.exports=d.Control.Geocoder}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../control":3}],7:[function(a,b){(function(c){!function(){"use strict";var d="undefined"!=typeof window?window.L:"undefined"!=typeof c?c.L:null;a("../util"),d.Control.Geocoder.MapQuest=d.Class.extend({initialize:function(a){this._key=decodeURIComponent(a)},_formatName:function(){var a,b=[];for(a=0;a<arguments.length;a++)arguments[a]&&b.push(arguments[a]);return b.join(", ")},geocode:function(a,b,c){d.Control.Geocoder._jsonp("//www.mapquestapi.com/geocoding/v1/address",{key:this._key,location:a,limit:5,outFormat:"json"},function(a){var e,f,g=[];if(a.results&&a.results[0].locations)for(var h=a.results[0].locations.length-1;h>=0;h--)e=a.results[0].locations[h],f=d.latLng(e.latLng),g[h]={name:this._formatName(e.street,e.adminArea4,e.adminArea3,e.adminArea1),bbox:d.latLngBounds(f,f),center:f};b.call(c,g)},this)},reverse:function(a,b,c,e){d.Control.Geocoder._jsonp("//www.mapquestapi.com/geocoding/v1/reverse",{key:this._key,location:a.lat+","+a.lng,outputFormat:"json"},function(a){var b,f,g=[];if(a.results&&a.results[0].locations)for(var h=a.results[0].locations.length-1;h>=0;h--)b=a.results[0].locations[h],f=d.latLng(b.latLng),g[h]={name:this._formatName(b.street,b.adminArea4,b.adminArea3,b.adminArea1),bbox:d.latLngBounds(f,f),center:f};c.call(e,g)},this)}}),d.control.geocoder.mapQuest=function(a){return new d.Control.Geocoder.MapQuest(a)},b.exports=d.Control.Geocoder}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util":9}],8:[function(a,b){(function(c){!function(){"use strict";var d="undefined"!=typeof window?window.L:"undefined"!=typeof c?c.L:null,e=a("corslite");a("../util"),d.Control.Geocoder.Nominatim=d.Class.extend({options:{serviceUrl:"//nominatim.openstreetmap.org/",geocodingQueryParams:{},reverseQueryParams:{},htmlTemplate:function(a){var b=a.address,c=[];return(b.road||b.building)&&c.push("{building} {road} {house_number}"),(b.city||b.town||b.village)&&c.push('<span class="'+(c.length>0?"leaflet-control-geocoder-address-detail":"")+'">{postcode} {city} {town} {village}</span>'),(b.state||b.country)&&c.push('<span class="'+(c.length>0?"leaflet-control-geocoder-address-context":"")+'">{state} {country}</span>'),d.Control.Geocoder.template(c.join("<br/>"),b,!0)}},initialize:function(a){d.Util.setOptions(this,a)},geocode:function(a,b,c){var f=d.extend({q:a,limit:5,format:"json",addressdetails:1},this.options.geocodingQueryParams),g=this.options.serviceUrl+"search/"+d.Util.getParamString(f);e(g,d.bind(function(a,e){var f,g=[];if(!a){f=JSON.parse(e.responseText);for(var h=f.length-1;h>=0;h--){for(var i=f[h].boundingbox,j=0;4>j;j++)i[j]=parseFloat(i[j]);g[h]={icon:f[h].icon,name:f[h].display_name,html:this.options.htmlTemplate?this.options.htmlTemplate(f[h]):void 0,bbox:d.latLngBounds([i[0],i[2]],[i[1],i[3]]),center:d.latLng(f[h].lat,f[h].lon),properties:f[h]}}b.call(c,g)}},this),"json_callback")},reverse:function(a,b,c,f){var g=d.extend({lat:a.lat,lon:a.lng,zoom:Math.round(Math.log(b/256)/Math.log(2)),addressdetails:1,format:"json"},this.options.reverseQueryParams),h=this.options.serviceUrl+"reverse/"+d.Util.getParamString(g);e(h,d.bind(function(a,b){var e,g,h=[];a||(e=JSON.parse(b.responseText),e&&e.lat&&e.lon&&(g=d.latLng(e.lat,e.lon),h.push({name:e.display_name,html:this.options.htmlTemplate?this.options.htmlTemplate(e):void 0,center:g,bounds:d.latLngBounds(g,g),properties:e})),c.call(f,h))},this),"json_callback")}}),d.control.geocoder.nominatim=function(a){return new d.Control.Geocoder.Nominatim(a)},b.exports=d.Control.Geocoder}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util":9,corslite:1}],9:[function(a,b){(function(c){!function(){"use strict";var d="undefined"!=typeof window?window.L:"undefined"!=typeof c?c.L:null;a("./control"),d.Control.Geocoder.template=function(a,b){return a.replace(/\{ *([\w_]+) *\}/g,function(a,c){var e=b[c];return void 0===e?e="":"function"==typeof e&&(e=e(b)),d.Control.Geocoder.htmlEscape(e)})},d.Control.Geocoder.htmlEscape=function(){function a(a){return d[a]}var b=/[&<>"'`]/g,c=/[&<>"'`]/,d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};return function(d){return null==d?"":d?(d=""+d,c.test(d)?d.replace(b,a):d):d+""}}(),b.exports=d.Control.Geocoder}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./control":3}]},{},[3])(3)});